{"version":3,"file":"watermark.min.js","sources":["../dist/watermark.js"],"sourcesContent":["/**\r\n * 水印\r\n * @param {Object} options 配置项\r\n * @param {String} options.name 水印的名称，会影响 cover 模式下水印层元素的 class 命名\r\n * @param {HTMLElement} options.carrierElem 水印层载体，默认在根元素（body）下\r\n * @param {Number} options.zIndex 水印层 z-index，默认 1000000\r\n * @param {String} options.mode mat|cover，放置模式，默认 mat（cover模式下为确保水印覆盖到，请检查载体宽高，mat 模式下水印的打印是非强制的，可能丢失）\r\n * @param {String} options.content 水印文字内容\r\n * @param {String} options.fontFamily 字体名\r\n * @param {String} options.fontWeight 字体粗细\r\n * @param {String} options.fontSize 字体大小\r\n * @param {String} options.fontColor 字体颜色\r\n * @param {String} options.baseline 文本基线设置（svg text alignment-baseline）\r\n * @param {Number} options.rotateDegree 旋转角度\r\n * @param {String} options.size 水印尺寸（css background-size）\r\n * @param {Number} options.margin 水印之间的外间距\r\n * @param {Number} options.padding 水印之间的内间距\r\n * @param {Boolean} options.needClip 是否裁切掉空白\r\n * @param {String} options.position 水印铺设位置（css background-position）\r\n * @param {String} options.repeat 水印铺设方式（css background-repeat）\r\n * @param {Number} options.opacity 透明度，同时影响水印及调试层\r\n * @param {Boolean} options.tuning 调试模式开关，设为 true 会在水印下添加 canvas 画布生成的参照底图，能够观察到 margin、padding、rotateDegree、baseline 等参数的设置效果，方便调试。只支持在 cover 模式下开启。\r\n * @param {Boolean} options.degraded 降级处理，更好的兼容性。canvas 的 measureText 本身具有对文字更精确的捕获，但因为兼容性问题，低版本浏览器对它的特性支持不完全，只得以 HTML DOM 的 getComputedStyle 取代 canvas measureText 来完成基础绘制和尺寸的捕获。\r\n * @example\r\n * // 基本使用\r\n * const waterMark=new WaterMark({\r\n *     text:'水印文字',\r\n * })\r\n * waterMark.draw()\r\n */\r\n\r\nclass WaterMark{\r\n    constructor(options){\r\n        this.options={...this.options,...options}\r\n    }\r\n\r\n    options={\r\n        name:'2080code-watermark',\r\n        carrierElem:document.body,\r\n        mode:'mat',\r\n        zIndex:100000,\r\n        content:'watermark',\r\n        fontWeight:'normal',\r\n        fontSize:'16px',\r\n        fontFamily:'Hei',\r\n        fontColor:'rgba(0,0,0,1)',\r\n        baseline:'before-edge',\r\n        rotateDegree:0,\r\n        size:'auto',\r\n        margin:0,\r\n        padding:0,\r\n        opacity:0.1,\r\n        needClip:true,\r\n        tuning:false,\r\n        degraded:false,\r\n        position:'center center',\r\n        repeat:'repeat',\r\n    }\r\n\r\n    draw(options){\r\n        const {\r\n            content,\r\n            fontWeight,\r\n            fontSize,\r\n            fontFamily,\r\n            fontColor,\r\n            baseline,\r\n            rotateDegree,\r\n            size,\r\n            margin,\r\n            padding,\r\n            opacity,\r\n            needClip,\r\n            tuning,\r\n            degraded,\r\n        }={...this.options,...options}\r\n        const fontStyle=[fontWeight,fontSize,fontFamily].join(' ')\r\n        const self=this\r\n        \r\n        function draft(){\r\n            const canvas = document.createElement('canvas'); // 创建canvas元素\r\n            const ctx=canvas.getContext('2d');\r\n            function setTxtProp(txt){\r\n                ctx.font=fontStyle;\r\n                ctx.fillStyle = 'red';\r\n                ctx.textAlign='start';\r\n                ctx.textBaseline = 'top';\r\n                return ctx.measureText(txt);\r\n            }\r\n            function txtDom(txt){\r\n                // 为兼容老浏览器（如 chrome <= 75）\r\n                const dom=document.createElement('span')\r\n                dom.style.display='inline-block';\r\n                dom.style.fontWeight=fontWeight\r\n                dom.style.fontSize=fontSize\r\n                dom.style.fontFamily=fontFamily\r\n                dom.innerText=txt\r\n                dom.style.visibility='hidden'\r\n                document.body.appendChild(dom)\r\n                const style=window.getComputedStyle(dom)\r\n                const size=JSON.parse(JSON.stringify({\r\n                    actualBoundingBoxRight:parseFloat(style.width),\r\n                    actualBoundingBoxDescent:parseFloat(style.height),\r\n                    actualBoundingBoxLeft:0,\r\n                    actualBoundingBoxAscent:0\r\n                }))\r\n                document.body.removeChild(dom)\r\n                return size\r\n            }\r\n            let txtProp=null\r\n            if(degraded){\r\n                txtProp=txtDom(content)\r\n            }else{\r\n                txtProp=setTxtProp(content)\r\n            }\r\n            // console.log(txtProp)\r\n            // debugger\r\n            const contWidth=txtProp.actualBoundingBoxRight +txtProp.actualBoundingBoxLeft;\r\n            const contHeight=txtProp.actualBoundingBoxDescent +txtProp.actualBoundingBoxAscent;\r\n            const radius=Math.sqrt(Math.pow(contWidth/2,2)+Math.pow(contHeight/2,2)); //圆弧半径（依据文字中心点到最远距离，用勾股定理算出半径）\r\n            const maxRadius=radius+padding; // 带 padding 的半径\r\n            const contOffsetX=maxRadius-contWidth/2;\r\n            const contOffsetY=maxRadius-contHeight/2;\r\n            const txtX=-maxRadius+contOffsetX+txtProp.actualBoundingBoxLeft;\r\n            const txtY=-maxRadius+contOffsetY+txtProp.actualBoundingBoxAscent;\r\n            const originAxis=[\r\n                [-contWidth/2,-contHeight/2], // 上左\r\n                [contWidth/2,-contHeight/2], // 上右\r\n                [contWidth/2,contHeight/2], // 下右\r\n                [-contWidth/2,contHeight/2] // 下左\r\n            ];\r\n            const radian=rotateDegree*Math.PI/180; // 旋转角度\r\n            const newAxis=originAxis.map(axis=>{\r\n                // 获取旋转后的四点新坐标\r\n                return [\r\n                    axis[0]*Math.cos(radian)-axis[1]*Math.sin(radian),\r\n                    axis[0]*Math.sin(radian)+axis[1]*Math.cos(radian)\r\n                ]\r\n            });\r\n            const clipStartAxis=[\r\n                Math.min(...newAxis.map(axis=>axis[0]))-padding,\r\n                Math.min(...newAxis.map(axis=>axis[1]))-padding\r\n            ];\r\n            const clipSize=[\r\n                Math.max(...newAxis.map(axis=>axis[0]))+padding,\r\n                Math.max(...newAxis.map(axis=>axis[1]))+padding\r\n            ].map(value=>value*2);\r\n\r\n            if(tuning){\r\n                canvas.width = maxRadius*2+margin;\r\n                canvas.height = maxRadius*2+margin;\r\n\r\n                ctx.globalAlpha=opacity;\r\n                ctx.translate(maxRadius,maxRadius); // 为旋转设置轴心\r\n                // 旋转\r\n                ctx.rotate(radian);\r\n\r\n                // text\r\n                // console.log('text',txtX,txtY)\r\n                setTxtProp(content);\r\n                ctx.fillText(content,txtX,txtY);\r\n\r\n                // 辅助绘制：\r\n                ctx.fillStyle = 'rgba(0,0,0,0.2)';\r\n                // 文字背景\r\n                ctx.beginPath();\r\n                ctx.strokeRect(-maxRadius+contOffsetX,-maxRadius+contOffsetY,contWidth,contHeight);\r\n                ctx.closePath();\r\n\r\n                // 水平线\r\n                ctx.setLineDash([5,15])\r\n                ctx.beginPath();\r\n                ctx.moveTo(-maxRadius, 0);\r\n                ctx.lineTo(maxRadius, 0);\r\n                ctx.closePath();\r\n                ctx.stroke();\r\n                \r\n                ctx.rotate(-radian);\r\n                ctx.setLineDash([])\r\n                \r\n                // 旋转轨道\r\n                ctx.beginPath();\r\n                ctx.arc(0, 0, maxRadius-padding, 0, Math.PI*2);\r\n                ctx.closePath();\r\n                ctx.stroke();\r\n                \r\n                // padding\r\n                ctx.beginPath();\r\n                ctx.arc(0, 0, maxRadius, 0, Math.PI*2);\r\n                ctx.closePath();\r\n                ctx.stroke();\r\n                \r\n                // 矩形区域坐标点\r\n                newAxis.forEach(axis=>{\r\n                    ctx.fillStyle = 'red';\r\n                    ctx.beginPath();\r\n                    ctx.arc(axis[0], axis[1], 1.5, 0, Math.PI*2);\r\n                    ctx.closePath();\r\n                    ctx.fill();\r\n                })\r\n\r\n                // 标出裁切区域\r\n                ctx.beginPath();\r\n                ctx.strokeRect(...clipStartAxis,...clipSize);\r\n                ctx.closePath();\r\n            }\r\n\r\n            if(needClip){\r\n                // clip\r\n                // console.log('newAxis',newAxis,clipStartAxis,clipSize)\r\n                let imgCopy=ctx.getImageData(...clipStartAxis,...clipSize.map(value=>value+maxRadius));\r\n                canvas.width = clipSize[0]+margin;\r\n                canvas.height = clipSize[1]+margin;\r\n                ctx.putImageData(imgCopy,...clipStartAxis.map(value=>value-(value+maxRadius)));\r\n            }\r\n\r\n            if(tuning){\r\n                self.put(canvas.toDataURL('image/png'),true)\r\n            }\r\n\r\n            return {\r\n                content,\r\n                rotateDegree,\r\n                margin,\r\n                width: canvas.width,\r\n                height: canvas.height,\r\n                contWidth,\r\n                contHeight,\r\n                txtProp,\r\n                fontStyle,\r\n                fontColor,\r\n                baseline,\r\n                opacity,\r\n                tuning\r\n            }\r\n        }\r\n        \r\n        this.svgGenerate(draft())\r\n    }\r\n\r\n    /**\r\n     * 生成svg水印本体\r\n     * @param {*} params 水印参数\r\n     * @returns String 水印base64 dataURL\r\n     */\r\n    svgGenerate(params){\r\n        let dataURL=''\r\n        let {x,y}={\r\n            x:(params.width-params.margin)/2-params.contWidth/2,\r\n            y:(params.height-params.margin)/2-params.contHeight/2\r\n        }\r\n        const rotateParams=[\r\n            params.rotateDegree,\r\n            x+params.contWidth/2,\r\n            y+params.contHeight/2\r\n        ].join(',')\r\n        const svg=document.createElement('svg')\r\n        const text=document.createElement('text')\r\n\r\n        // <svg>\r\n        svg.setAttribute('xmlns','http://www.w3.org/2000/svg')\r\n        svg.setAttribute('width',params.width)\r\n        svg.setAttribute('height',params.height)\r\n        svg.setAttribute('version','1.1')\r\n\r\n        // <text>\r\n        text.innerText=params.content\r\n        text.style=[\r\n            `font:${params.fontStyle}`,\r\n            `fill:${params.fontColor}`,\r\n            'text-anchor:start',\r\n            `alignment-baseline:${params.baseline}`,\r\n        ].join('; ')\r\n        text.setAttribute('x',x+params.txtProp.actualBoundingBoxLeft) // svg 的 text 无法获取具体的文字渲染参数，利用 canvas 的 measureText 来修正对齐基准偏移\r\n        text.setAttribute('y',y+params.txtProp.actualBoundingBoxAscent)\r\n        text.setAttribute('transform',`rotate(${rotateParams})`)\r\n        text.setAttribute('opacity',params.opacity)\r\n\r\n        // if(params.tuning){\r\n        //     // <rect>\r\n        //     let rect=document.createElement('rect')\r\n        //     rect.setAttribute('x',x)\r\n        //     rect.setAttribute('y',y)\r\n        //     rect.setAttribute('width',params.contWidth)\r\n        //     rect.setAttribute('height',params.contHeight)\r\n        //     rect.setAttribute('fill','yellow')\r\n        //     rect.setAttribute('stroke','red')\r\n        //     rect.setAttribute('transform',`rotate(${rotateParams})`)\r\n        //     svg.append(rect)\r\n        // }\r\n\r\n        svg.append(text)\r\n\r\n        dataURL='data:image/svg+xml;base64,'+window.btoa(window.unescape(encodeURIComponent(svg.outerHTML)))\r\n        // console.log('svgGenerate',svg,params,dataURL)\r\n        this.put(dataURL)\r\n        return dataURL\r\n    }\r\n\r\n    /**\r\n     * 水印放置\r\n     * @param {String} imgURL 水印内容，base64\r\n     * @param {Boolean} isTuning 是否为调试模式\r\n     */\r\n    put(imgURL,isTuning){\r\n        let elemID=this.options.name+(isTuning?'-tuning':'')\r\n        let existElem=document.getElementById(elemID)\r\n        let elem=null\r\n        let carrierElem=this.options.carrierElem;\r\n        if(this.options.mode==='cover'){\r\n            elem=existElem||document.createElement('div')\r\n            elem.id=elemID\r\n        }else{\r\n            elem=carrierElem||document.body\r\n        };\r\n\r\n        elem.style=[\r\n            elem.style.cssText,\r\n            '-webkit-print-color-adjust:exact',\r\n            'print-color-adjust:exact',\r\n            'color-adjust:exact',\r\n            `background-image:url(${imgURL})`, // 水印内容\r\n            `background-position:${this.options.position}`,\r\n            `background-repeat:${this.options.repeat}`,\r\n            `background-size:${this.options.size}`\r\n            \r\n        ].join('!important;');\r\n        \r\n        if(this.options.mode==='cover'){\r\n            elem.style=[\r\n                elem.style.cssText,\r\n                'pointer-events:none',\r\n                'position:absolute',\r\n                `z-index:${this.options.zIndex}`,\r\n                'top:0',\r\n                'left:0',\r\n                'width:100%',\r\n                'height:100%'\r\n            ].join('!important;');\r\n\r\n            carrierElem.style.position='relative';\r\n            if(!existElem){\r\n                carrierElem.append(elem);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default WaterMark\r\n"],"names":["g","f","exports","module","define","amd","globalThis","self","WaterMark","this","constructor","options","name","carrierElem","document","body","mode","zIndex","content","fontWeight","fontSize","fontFamily","fontColor","baseline","rotateDegree","size","margin","padding","opacity","needClip","tuning","degraded","position","repeat","draw","fontStyle","join","svgGenerate","canvas","createElement","ctx","getContext","setTxtProp","txt","font","fillStyle","textAlign","textBaseline","measureText","txtProp","dom","style","display","innerText","visibility","appendChild","window","getComputedStyle","JSON","parse","stringify","actualBoundingBoxRight","parseFloat","width","actualBoundingBoxDescent","height","actualBoundingBoxLeft","actualBoundingBoxAscent","removeChild","txtDom","contWidth","contHeight","maxRadius","Math","sqrt","pow","contOffsetX","contOffsetY","txtX","txtY","originAxis","radian","PI","newAxis","map","axis","cos","sin","clipStartAxis","min","clipSize","max","value","globalAlpha","translate","rotate","fillText","beginPath","strokeRect","closePath","setLineDash","moveTo","lineTo","stroke","arc","forEach","fill","imgCopy","getImageData","putImageData","put","toDataURL","draft","params","dataURL","x","y","rotateParams","svg","text","setAttribute","append","btoa","unescape","encodeURIComponent","outerHTML","imgURL","isTuning","elemID","existElem","getElementById","elem","id","cssText"],"mappings":"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"}